FROM ubuntu:latest
LABEL maintainer="Hosub Lee <spyrr83@gmail.com>"

ENV HOME /root
ENV LC_ALL en_US.UTF-8
ENV DEBIAN_FRONTEND noninteractive

# Setup base systems
RUN apt-get update && apt-get -y upgrade && \
    apt-get install -y apt-utils locales language-pack-en&& \
    locale-gen en_US.UTF-8 && \
    dpkg-reconfigure locales && \
    apt-get install -y man zsh

# Development Env.
RUN apt-get install -y vim iputils-ping curl wget silversearcher-ag && \
    apt-get install -y software-properties-common git && \
    apt-get install -y build-essential gcc gdb make && \
    apt-get install -y python python-dev python-pip  && \
    apt-get install -y python3 python3-dev python3-pip &&\
    apt-get install -y virtualenv nmap netcat net-tools tmux && \
    apt-get install -y binwalk qemu-user-static

WORKDIR /root

# Install oh-my-zsh
ENV CHSH no
ENV RUNZSH no
RUN sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"

# Install dotfiles
RUN sh -c "$(curl -fsSL https://raw.githubusercontent.com/spyrr/.dotfiles/master/bin/install.sh)"

# Setup virtualenv for pwn
RUN mkdir .py
RUN pip install -U pip
RUN pip3 install -U pip
RUN virtualenv --python=python3 .py/pwn
ENV PATH="/root/.py/pwn/bin:$PATH"
RUN pip install pwntools pycrypto ipython z3-solver frida

# Install pwndbg
RUN git clone https://github.com/pwndbg/pwndbg
WORKDIR /root/pwndbg
RUN ./setup.sh

WORKDIR /root
EXPOSE 80
CMD ["/usr/bin/zsh"]